<template>
  <section class="section">
    <div class="container">
      <!-- Section Header -->
      <div class="text-left mb-10">
        <h2 class="section-title">Часто задаваемые вопросы</h2>
      </div>

      <!-- FAQ Accordion -->
      <div class="space-y-3">
        <div 
          v-for="(item, index) in faqItems" 
          :key="item.id"
          class="bg-gray-50 rounded-2xl overflow-hidden border border-gray-100 hover:border-primary-200 transition-colors"
          :class="openItems.includes(index) ? 'border-l-4 border-l-blue-500' : ''"
        >
          <!-- Question -->
          <button 
            @click="toggleItem(index)"
            class="w-full flex items-center justify-between p-5 md:p-6 text-left"
          >
            <span class="text-base md:text-lg font-semibold text-gray-800 pr-4">
              {{ item.question }}
            </span>
            <span 
              class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-primary-900 bg-white border border-gray-200 transition-transform duration-300"
              :class="openItems.includes(index) ? 'rotate-45 bg-primary-900 text-white border-[#0a1744]' : ''"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m6-6H6"/>
              </svg>
            </span>
          </button>

          <!-- Answer -->
          <Transition name="accordion">
            <div v-if="openItems.includes(index)" class="overflow-hidden">
              <div class="px-5 md:px-6 pb-5 md:pb-6">
                <div class="prose prose-gray max-w-none text-gray-600" v-html="item.answer"></div>
                <!-- Optional Link -->
                <a 
                  v-if="item.link"
                  :href="item.link"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 mt-4 text-primary-900 font-semibold hover:text-[#1a3a8a] transition-colors"
                >
                  {{ item.linkText || 'Подробнее' }}
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                  </svg>
                </a>
              </div>
            </div>
          </Transition>
        </div>
      </div>

    </div>
  </section>
</template>

<script setup lang="ts">
interface FAQItem {
  id?: number
  question: string
  answer: string
  link?: string
  linkText?: string
}

interface Props {
  items?: FAQItem[]
}

const props = withDefaults(defineProps<Props>(), {
  items: () => []
})

const openItems = ref<number[]>([])

const toggleItem = (index: number) => {
  const itemIndex = openItems.value.indexOf(index)
  if (itemIndex > -1) {
    openItems.value.splice(itemIndex, 1)
  } else {
    openItems.value.push(index)
  }
}

// Use props.items if provided, otherwise use defaults
const defaultFaqItems: FAQItem[] = [
  {
    id: 1,
    question: 'Как проходит практика при обучении на права и категорию спецтехники?',
    answer: `
      <p>Тракторные-права.РФ имеет собственный полигон с современной самоходной и спецтехникой под руководством опытных инструкторов, что позволяет отработать навыки управления для дальнейшего получения категории на спецтехнику.</p>
      <p>Экзамен для получения прав в Гостехнадзор (ГТН) проводится на той же технике, на которой проходили практику.</p>
    `
  },
  {
    id: 2,
    question: 'Сколько времени действует удостоверение, выданное в Гостехнадзоре?',
    answer: `
      <p>Удостоверение тракториста-машиниста (УТМ) выдаётся сроком на <strong>10 лет</strong>, после чего его можно обновить в Гостехнадзоре (ГТН) без необходимости прохождения дополнительного обучения.</p>
      <p>Свидетельство и удостоверение о присвоении рабочей специальности действительны <strong>бессрочно</strong>.</p>
      <p>Однако, при желании получить новый разряд по своей специальности, слушатели могут запросить так называемое «продление» удостоверения, что фактически является получением нового разряда.</p>
      <p>Кроме того, в некоторых компаниях существуют <strong>внутренние регламенты</strong>, требующие от сотрудников регулярно, раз в год, три или пять лет, проходить повышение квалификации.</p>
    `
  },
  {
    id: 3,
    question: 'Как происходит замена УТМ в Гостехнадзор?',
    answer: `
      <p>Поменять права (удостоверение тракториста) в Гостехнадзор после истечения срока его действия или в случае изменения ФИО можно без сдачи экзаменов.</p>
      <p>Для этого необходимо подать заявку, которую можно выполнить онлайн на портале mos.ru, за исключением случаев, требующих личного визита в Гостехнадзор.</p>
      <p><strong>Для подачи заявления потребуются отсканированные копии следующих документов:</strong></p>
      <ul>
        <li>Документ, удостоверяющий личность (иностранные граждане должны предоставить нотариально заверенный перевод)</li>
        <li>Документ, подтверждающий регистрацию по месту жительства или пребывания</li>
        <li>Медицинское заключение о допуске к управлению самоходными машинами</li>
        <li>Удостоверение тракториста-машиниста</li>
        <li>Индивидуальная карточка тракториста-машиниста (при наличии)</li>
        <li>Водительское удостоверение, выданное на территории РФ (для категорий AII, AIII, AIV)</li>
        <li>Квитанция об уплате госпошлины</li>
      </ul>
      <p>После подачи заявления необходимо записаться в Гостехнадзор и прийти в назначенное время с оригиналами документов и двумя фотографиями размером 3x4 см на матовой бумаге.</p>
      <p><strong>Важно:</strong> если вас лишили права управления транспортными средствами, то удостоверение на право управления самоходными машинами вам не выдадут.</p>
    `
  },
  {
    id: 4,
    question: 'Какие гарантии, что я не столкнусь с обманом, получу необходимые знания и официальные документы?',
    answer: `
      <p>Образовательный центр «Тракторные-права.РФ» обладает всеми необходимыми документами для ведения образовательной деятельности, включая лицензии.</p>
      <ul>
        <li>Проверить эти документы можно на официальных сайтах контролирующих органов в соответствующих реестрах</li>
        <li>При покупке курса с клиентом заключается договор, который содержит все условия и обязательства сторон</li>
        <li>Центр ценит свою деловую репутацию, стремится идти навстречу слушателям и избегает конфликтных ситуаций</li>
      </ul>
      <p><strong>Признаки мошенничества, на которые следует обратить внимание при выборе других образовательных учреждений:</strong></p>
      <ul>
        <li>Чрезмерно низкая стоимость курсов. Качественное образование требует адекватной оплаты труда педагогов</li>
        <li>Предложение оплаты на сомнительные банковские реквизиты, в том числе на личные счета физических лиц</li>
        <li>Требования внести дополнительные платежи за неоговоренные услуги</li>
      </ul>
      <p>Перед оплатой обучения тщательно изучите договор, запросите лицензию и убедитесь, что она действительно выдана организации, реквизиты которой указаны в договоре.</p>
    `
  },
  {
    id: 5,
    question: 'Какие документы необходимо предоставить, чтобы записаться на обучение на спецтехнику?',
    answer: `
      <p><strong>Для того, чтобы записаться на курс по управлению самоходными машинами и спецтехникой, необходимо предоставить следующий набор документов:</strong></p>
      <ul>
        <li>Копия паспорта (первая страница и страница с регистрацией)</li>
        <li>СНИЛС</li>
        <li>Медицинская справка с отметкой о допуске к управлению тракторами и другими самоходными машинами (форма 071У)</li>
        <li>Цветное фото в электронном виде для документов</li>
        <li>При наличии: копия водительского удостоверения РФ</li>
        <li>При наличии: копия тракторных прав и индивидуальная карточка</li>
      </ul>
      <p><strong>Для иностранных граждан дополнительно требуется:</strong></p>
      <ul>
        <li>Вид на жительство или регистрация</li>
        <li>Копия нотариально заверенного перевода паспорта</li>
      </ul>
    `
  },
  {
    id: 6,
    question: 'Как узнать, что лицензия вашего учебного центра действительна?',
    answer: `
      <p>Информацию о лицензии учебного центра дополнительного профессионального образования можно проверить на официальном веб-сайте Федеральной службы по надзору в области образования и науки.</p>
    `,
    link: 'https://islod.obrnadzor.gov.ru/rlic/details/53689dae-e80f-c0ba-c887-d89b8a2e13e5/',
    linkText: 'Проверить лицензию'
  },
  {
    id: 7,
    question: 'Как происходит процесс сдачи экзамена на право управления самоходными машинами?',
    answer: `
      <p>Экзамен на право управления самоходной техникой проводится в образовательных учреждениях и включает в себя две части — теоретическую и практическую.</p>
      <p>После успешной сдачи теоретического экзамена, кандидаты могут приступать к практической части. Оценка за теоретический экзамен остаётся действительной в течение трёх месяцев.</p>
      <p><strong>Практический экзамен состоит из двух этапов:</strong></p>
      <ol>
        <li>На закрытой площадке или трактородроме</li>
        <li>На специально подготовленном маршруте в реальных дорожных условиях</li>
      </ol>
      <p>После успешной сдачи экзамена кандидату сообщат, когда он может прийти за удостоверением. Документы, подтверждающие право управления, выдаются на следующий рабочий день после сдачи экзамена. Срок действия удостоверения составляет <strong>10 лет</strong>.</p>
      <p>Кроме того, кандидату выдают индивидуальную карточку, возвращают документ о прохождении обучения и медицинское заключение.</p>
      <p>В случае неудачной сдачи теоретической или практической части, экзамен можно пересдать через 7 дней. Если же практическую часть не удаётся сдать три раза, необходимо будет повторно пройти обучение.</p>
    `
  },
  {
    id: 8,
    question: 'Какие документы являются официальными?',
    answer: `
      <p>Согласно Федеральному закону № 273-ФЗ «Об образовании в Российской Федерации» (статья 60), лицам, успешно прошедшим итоговую аттестацию, выдаются документы о квалификации.</p>
      <p>По результатам профессионального обучения выдаётся <strong>свидетельство о профессии рабочего, должности служащего</strong>, подтверждающее присвоение разряда или класса по профессии.</p>
      <p>Данный документ не является дипломом, а является официальным свидетельством о квалификации, имеющим юридическую силу на всей территории Российской Федерации.</p>
    `
  },
  {
    id: 9,
    question: 'Как проверить подлинность удостоверения в реестре?',
    answer: `
      <p><strong>Для проверки удостоверений на сайте ФРДО Рособрнадзора следуйте указанным шагам:</strong></p>
      <ol>
        <li>Перейдите на страницу проверки удостоверений ФРДО Рособрнадзора</li>
        <li>Найдите красный заголовок «СЕРВИС ПОИСКА СВЕДЕНИЙ О ДОКУМЕНТАХ ОБ ОБРАЗОВАНИИ» и кликните по надписи «Открыть»</li>
        <li>В открывшемся списке «Уровень образования» выберите «Дополнительное профессиональное образование» или «Профессиональное обучение»</li>
        <li>Нажмите кнопку «Найти по справочнику» и введите «Псковский учебно»</li>
        <li>Выберите «Автономно некоммерческая организация дополнительного профессионального образования «Псковский учебно-образовательный центр»</li>
      </ol>
      <p><strong>Затем заполните поля данными из удостоверения:</strong></p>
      <ul>
        <li>Фамилия слушателя</li>
        <li>Серия бланка — буквенное обозначение серии (например: ПСК)</li>
        <li>Номер бланка — цифровой номер (например: 12345)</li>
        <li>Регистрационный номер — номер удостоверения (например: E-A-11111)</li>
        <li>Дата выдачи в формате ДД.ММ.ГГГГ (например: 22.11.2019)</li>
        <li>Буквы и цифры с изображения для проверки</li>
      </ul>
    `,
    link: 'https://obrnadzor.gov.ru/gosudarstvennye-uslugi-i-funkczii/7701537808-gosfunction/formirovanie-i-vedenie-federalnogo-reestra-svedenij-o-dokumentah-ob-obrazovanii-i-ili-o-kvalifikaczii-dokumentah-ob-obuchenii/#service-search',
    linkText: 'Проверить'
  }
]

// Use props.items if provided and not empty, otherwise use defaults
const faqItems = computed(() =>
  props.items && props.items.length > 0 ? props.items : defaultFaqItems
)
</script>

<style scoped>
.accordion-enter-active,
.accordion-leave-active {
  transition: all 0.3s ease;
  max-height: 1000px;
}

.accordion-enter-from,
.accordion-leave-to {
  max-height: 0;
  opacity: 0;
}

.prose :deep(ul) {
  list-style-type: disc;
  list-style-position: inside;
  margin-top: 0.75rem;
  margin-bottom: 0.75rem;
}

.prose :deep(ol) {
  list-style-type: decimal;
  list-style-position: inside;
  margin-top: 0.75rem;
  margin-bottom: 0.75rem;
}

.prose :deep(strong) {
  font-weight: 600;
  color: #1f2937;
}

.prose :deep(p) {
  margin-bottom: 0.75rem;
  line-height: 1.625;
}

.prose :deep(p:last-child) {
  margin-bottom: 0;
}
</style>
